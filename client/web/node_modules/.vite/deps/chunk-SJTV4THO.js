import {
  require_superTokens,
  require_utils
} from "./chunk-3ZRDDZCO.js";
import {
  require_jsx_runtime
} from "./chunk-2YVA4HRZ.js";
import {
  require_react
} from "./chunk-WUR7D6NS.js";
import {
  __commonJS
} from "./chunk-G3PMV62Z.js";

// node_modules/supertokens-auth-react/lib/build/translationContext.js
var require_translationContext = __commonJS({
  "node_modules/supertokens-auth-react/lib/build/translationContext.js"(exports) {
    "use strict";
    var utils = require_utils();
    var jsxRuntime = require_jsx_runtime();
    var React = require_react();
    var superTokens = require_superTokens();
    function _interopDefault(e) {
      return e && e.__esModule ? e : { default: e };
    }
    var React__default = _interopDefault(React);
    var errCB = function() {
      throw new Error("Cannot use translation func outside TranslationContext provider.");
    };
    var TranslationContext = React__default.default.createContext({
      translate: errCB
    });
    var useTranslation = function() {
      return React.useContext(TranslationContext).translate;
    };
    var TranslationContextProvider = function(_a) {
      var children = _a.children, defaultLanguage = _a.defaultLanguage, userTranslationFunc = _a.userTranslationFunc, defaultStore = _a.defaultStore, translationControlEventSource = _a.translationControlEventSource;
      var _b = React.useState(defaultStore), translationStore = _b[0], setTranslationStore = _b[1];
      var _c = React.useState(void 0), currentLanguage = _c[0], setCurrentLanguage = _c[1];
      React.useEffect(
        function() {
          function loadLanguageFromCookies() {
            return utils.__awaiter(this, void 0, void 0, function() {
              var cookieLang, cookieLangTemp;
              return utils.__generator(this, function(_a2) {
                switch (_a2.label) {
                  case 0:
                    return [4, superTokens.getCurrentLanguageFromCookie()];
                  case 1:
                    cookieLang = _a2.sent();
                    cookieLangTemp = cookieLang === null ? defaultLanguage : cookieLang;
                    setCurrentLanguage(function(current) {
                      return current !== void 0 ? current : cookieLangTemp;
                    });
                    return [
                      2
                      /*return*/
                    ];
                }
              });
            });
          }
          void loadLanguageFromCookies();
        },
        [defaultLanguage, setCurrentLanguage]
      );
      React.useEffect(function() {
        var changeHandler = function(_eventName, detail) {
          setCurrentLanguage(detail);
        };
        var loadHandler = function(_eventName, detail) {
          setTranslationStore(function(os) {
            return utils.mergeObjects(os, detail);
          });
        };
        translationControlEventSource.on("LanguageChange", changeHandler);
        translationControlEventSource.on("TranslationLoaded", loadHandler);
        return function() {
          translationControlEventSource.off("LanguageChange", changeHandler);
          translationControlEventSource.off("TranslationLoaded", loadHandler);
        };
      });
      var translateFunc = React.useCallback(
        function(key) {
          if (userTranslationFunc !== void 0) {
            return userTranslationFunc(key);
          }
          if (currentLanguage !== void 0) {
            var res = translationStore[currentLanguage] && translationStore[currentLanguage][key];
            var fallback = translationStore[defaultLanguage] && translationStore[defaultLanguage][key];
            if (res === void 0) {
              if (fallback !== void 0) {
                return fallback;
              }
              return key;
            }
            return res;
          }
          throw new Error("Should never come here");
        },
        [translationStore, currentLanguage, defaultLanguage, userTranslationFunc]
      );
      if (currentLanguage === void 0) {
        return null;
      }
      return jsxRuntime.jsx(
        TranslationContext.Provider,
        utils.__assign({ value: { translate: translateFunc } }, { children })
      );
    };
    exports.TranslationContextProvider = TranslationContextProvider;
    exports.useTranslation = useTranslation;
  }
});

export {
  require_translationContext
};
//# sourceMappingURL=chunk-SJTV4THO.js.map
